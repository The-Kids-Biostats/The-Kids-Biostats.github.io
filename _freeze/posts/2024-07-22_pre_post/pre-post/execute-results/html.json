{
  "hash": "e12fd5add033ef4093e7df5f34d045f2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Analysing pre-post data\"\nformat:\n  html:\n    code-fold: true\n    toc: true\n    toc-location: left\ndate: \"2024-07-22\"\nauthor: \"Dr Matthew Cooper\"\ncategories:\n  - Pre-post\n  - Mixed Models\n  - R\ndraft: false\n---\n\n\n\n\n\n\n\n# Overview\n\nPre-post designs are in use everywhere we look. Before and after treatment, e.g. in a randomised clinical trial, might be the example that most readily comes to mind for analysts in the health sciences area. However, the pre-post concept occurs in many non-randomised settings as well, like observational studies or retrospective policy evaluation studies, and can feature in our daily lives without us even knowing it (like in A/B testing to see if you spend just a little bit longer on social media or buy that chocolate bar at the checkout).\n\nWhile in principle, the set-up (premise) for such a question seems straightforward, there is extensive literature debating the different approaches to the analysis of this data. The discussions around these choices may confuse the lay or even semi-experienced analyst. Often these discussions are held without a serviceable example to illustrate implementation.\n\nBelow is an example to help provide some direct links between what we see with raw data and model output, when tackling this question.\n\n# Analysis options\n\nThe context here is two groups, that both have a pre and a post measure, but they differ in some property (we'll use 'treatment' in the sense of a 'treatment' intervention group compared to a control group). When we have pre-post data like this *(focusing on continuous, approximately normally distributed data here)*, there are three basic approaches analysts may reach for:\n\n-   **Change score analysis**\n    -   The outcome data for each participant is reduced to one data point (a change score: post-value minus pre-value)\n    -   This can just be analysed with a t.test or alternatively as the outcome variable of a linear regression model with the treatment variable as the exposure of interest (on the right hand side (RHS) of the model)\n    -   Other variations on this theme are also possible\n-   **Linear regression (ANCOVA framework)**\n    -   The data is structured as one row per participant, with two variables (columns) representing the outcome (one for the pre-measure, one for post-measure)\n    -   In the ANCOVA (Analysis of covariance) framework, the outcome variable is the post-value, and both the treatment variable (as the exposure of interest) AND the pre-value (as an adjustment variable) are included on the RHS of the model\n-   **Linear mixed effects models**\n    -   *Can be structured in the same way as linear regression, via an ANCOVA framework (and this will reduce to linear regression in certain situations),* OR\n    -   the data is structured as two rows per participant, with one row for the pre-data and one row for the post-data (there will then be a variable (column) here that represents timepoint, with values `pre` and `post`)\n        -   both the pre- and post-measures are on the left hand side (LHS) of the model, with an interaction term between the treatment variable and timepoint on the RHS of the model (as the variable of interest)\n\nThere are a number of nuanced variations on these methods to be aware of. This post is not strictly focused on randomised controlled trials, for which a lot of [methodological literature](https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/s12874-021-01323-9) [addressing this](https://psycnet.apa.org/doiLanding?doi=10.1037%2Fh0025105) [decision exists](https://onlinelibrary.wiley.com/doi/10.1002/sim.2682) - it is intended to be a light, applied look at model implementation and interpretation (in light of examining the raw data).\n\nLinear regression (ANCOVA framework) is [typically\\* the recommended approach](https://doi.org/10.4172%2F2155-6180.1000334), but varied disciplines can lean more towards the other two methods.\n\n::: callout-note\n## Note.\n\nTypically, statisticians are very reserved about making broad sweeping methodological recommendations. Typically - I share that reservation.\n:::\n\n# Setting the scene\n\nWe're going to use some simulated data here, generated using the [`simstudy`](https://cran.r-project.org/web/packages/simstudy/index.html) package.\n\nWe generate a dataset based on the following:\n\n-   Data for 204 treatment patients\n    -   pre-data is random value with a mean of 20 (SD 5)\n    -   post-data [is the pre-value plus]{.underline} a random value with a mean of 50 (SD 5)\n-   Data for 197 control patients\n    -   pre-data is random with a mean of 10 (SD 5)\n    -   post-data [is the pre-value plus]{.underline} a random value with a mean of 20 (SD 5)\n-   Pre-data is measured between days (time) 0 to 28 \\[largely ignored\\]\n-   Post-data is measured between days (time) 150 and 210 \\[largely ignored\\]\n-   The actual `time` variable, we will use in future examples with this dataset. For this post we will use the `timepoint` variable which simply differentiates the data as `pre` or `post`.\n\nFor full readability, we do this in four steps, and then combine. Let's have a look:\n\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n        id     group  time      out timepoint\n     <int>    <char> <int>    <num>    <char>\n  1:     1 treatment     1 20.71677       pre\n  2:     2 treatment     4 19.95806       pre\n  3:     3 treatment    12 25.49292       pre\n  4:     4 treatment    27 28.72701       pre\n  5:     5 treatment    16 19.74429       pre\n ---                                         \n798:   397   control   184 26.37403      post\n799:   398   control   156 36.85208      post\n800:   399   control   177 22.81521      post\n801:   400   control   206 35.56838      post\n802:   401   control   193 34.11446      post\n```\n\n\n:::\n:::\n\n\n\n\n\nLet's look at the means of the data (remembering what we set them to be).\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"awkenskjer\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#awkenskjer table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#awkenskjer thead, #awkenskjer tbody, #awkenskjer tfoot, #awkenskjer tr, #awkenskjer td, #awkenskjer th {\n  border-style: none;\n}\n\n#awkenskjer p {\n  margin: 0;\n  padding: 0;\n}\n\n#awkenskjer .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 14px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#awkenskjer .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#awkenskjer .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#awkenskjer .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#awkenskjer .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#awkenskjer .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#awkenskjer .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#awkenskjer .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#awkenskjer .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#awkenskjer .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#awkenskjer .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#awkenskjer .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#awkenskjer .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#awkenskjer .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#awkenskjer .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#awkenskjer .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#awkenskjer .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#awkenskjer .gt_row {\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#awkenskjer .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#awkenskjer .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#awkenskjer .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#awkenskjer .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#awkenskjer .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#awkenskjer .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#awkenskjer .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#awkenskjer .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#awkenskjer .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#awkenskjer .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#awkenskjer .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#awkenskjer .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#awkenskjer .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#awkenskjer .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#awkenskjer .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#awkenskjer .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#awkenskjer .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#awkenskjer .gt_left {\n  text-align: left;\n}\n\n#awkenskjer .gt_center {\n  text-align: center;\n}\n\n#awkenskjer .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#awkenskjer .gt_font_normal {\n  font-weight: normal;\n}\n\n#awkenskjer .gt_font_bold {\n  font-weight: bold;\n}\n\n#awkenskjer .gt_font_italic {\n  font-style: italic;\n}\n\n#awkenskjer .gt_super {\n  font-size: 65%;\n}\n\n#awkenskjer .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#awkenskjer .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#awkenskjer .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#awkenskjer .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#awkenskjer .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#awkenskjer .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#awkenskjer .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Variable&lt;/strong&gt;\"><strong>Variable</strong></th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"&lt;strong&gt;control&lt;/strong&gt;, N = 394\">\n        <span class=\"gt_column_spanner\"><strong>control</strong>, N = 394</span>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"&lt;strong&gt;treatment&lt;/strong&gt;, N = 408\">\n        <span class=\"gt_column_spanner\"><strong>treatment</strong>, N = 408</span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;em&gt;pre&lt;/em&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><em>pre</em><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;em&gt;post&lt;/em&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><em>post</em><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;em&gt;pre&lt;/em&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><em>pre</em><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;em&gt;post&lt;/em&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><em>post</em><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\"><div data-qmd=\"out\"><div class='gt_from_md'><p>out</p>\n</div></div></td>\n<td headers=\"stat_1_1\" class=\"gt_row gt_center\"><div data-qmd=\"10.11 (4.9)  \n[197]\"><div class='gt_from_md'><p>10.11 (4.9)<br />\n[197]</p>\n</div></div></td>\n<td headers=\"stat_2_1\" class=\"gt_row gt_center\"><div data-qmd=\"30.45 (6.6)  \n[197]\"><div class='gt_from_md'><p>30.45 (6.6)<br />\n[197]</p>\n</div></div></td>\n<td headers=\"stat_1_2\" class=\"gt_row gt_center\"><div data-qmd=\"20.55 (5.2)  \n[204]\"><div class='gt_from_md'><p>20.55 (5.2)<br />\n[204]</p>\n</div></div></td>\n<td headers=\"stat_2_2\" class=\"gt_row gt_center\"><div data-qmd=\"70.79 (6.9)  \n[204]\"><div class='gt_from_md'><p>70.79 (6.9)<br />\n[204]</p>\n</div></div></td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"5\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> Mean (SD)<br />\n[No. obs.]</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\nThis all makes sense:\n\n-   The control group mean increases by \\~20\n-   The treatment group mean increases by \\~50\n\n### A visual of our data\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndat %>% \n  mutate(timepoint = factor(timepoint, levels = c(\"pre\", \"post\"))) %>% \n  ggplot(aes(timepoint, out, group = group, colour = group)) +\n  geom_jitter(position = position_jitterdodge(jitter.width = 0.1, dodge.width = 0.25), alpha = 0.3) +\n  geom_smooth(position = position_dodge(width = 0.25), \n              method = \"lm\", formula= y ~ x) +\n  theme_clean() +\n  scale_colour_viridis_d(option = \"plasma\", end = 0.85) +\n  labs(y = \"Outcome\", x = \"Timepoint\",\n       title = \"Pre-post analysis\", \n       subtitle = \"Two-groups, jitterplot with line connecting observed means\", colour = \"Group\")\n```\n\n::: {.cell-output-display}\n![](pre-post_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=576}\n:::\n:::\n\n\n\n\n\n# Question\n\n**What is the treatment effect?**\n\nThere is a lot in that question. There is extensive literature (existing and emerging) on estimands, estimators of the estimands (see [here for a recent discussion in the cluster randomised trials space](https://journals.sagepub.com/doi/full/10.1177/09622802241254197)), and more broadly in just defining the 'treatment effect'; this discussion, particularly as it relates to establishing a standardised nomenclature in this space, is incredibly valuable.\n\nFor the purposes of this applied example, we are going to assume the reader wants to 'understand the post-treatment differences between groups, factoring in any baseline imbalance'.\n\nLet's dive into the three methods we outlined above.\n\n## Change score analysis\n\nLet's reduce the two observations we have per participant into one 'difference' (change score: post-value minus pre-value).\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"unhdjkjcwc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#unhdjkjcwc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#unhdjkjcwc thead, #unhdjkjcwc tbody, #unhdjkjcwc tfoot, #unhdjkjcwc tr, #unhdjkjcwc td, #unhdjkjcwc th {\n  border-style: none;\n}\n\n#unhdjkjcwc p {\n  margin: 0;\n  padding: 0;\n}\n\n#unhdjkjcwc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 14px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#unhdjkjcwc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#unhdjkjcwc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#unhdjkjcwc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#unhdjkjcwc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#unhdjkjcwc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#unhdjkjcwc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#unhdjkjcwc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#unhdjkjcwc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#unhdjkjcwc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#unhdjkjcwc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#unhdjkjcwc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#unhdjkjcwc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#unhdjkjcwc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#unhdjkjcwc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#unhdjkjcwc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#unhdjkjcwc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#unhdjkjcwc .gt_row {\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#unhdjkjcwc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#unhdjkjcwc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#unhdjkjcwc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#unhdjkjcwc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#unhdjkjcwc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#unhdjkjcwc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#unhdjkjcwc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#unhdjkjcwc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#unhdjkjcwc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#unhdjkjcwc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#unhdjkjcwc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#unhdjkjcwc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#unhdjkjcwc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#unhdjkjcwc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#unhdjkjcwc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#unhdjkjcwc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#unhdjkjcwc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#unhdjkjcwc .gt_left {\n  text-align: left;\n}\n\n#unhdjkjcwc .gt_center {\n  text-align: center;\n}\n\n#unhdjkjcwc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#unhdjkjcwc .gt_font_normal {\n  font-weight: normal;\n}\n\n#unhdjkjcwc .gt_font_bold {\n  font-weight: bold;\n}\n\n#unhdjkjcwc .gt_font_italic {\n  font-style: italic;\n}\n\n#unhdjkjcwc .gt_super {\n  font-size: 65%;\n}\n\n#unhdjkjcwc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#unhdjkjcwc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#unhdjkjcwc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#unhdjkjcwc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#unhdjkjcwc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#unhdjkjcwc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#unhdjkjcwc .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;control&lt;/strong&gt;, N = 197&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>control</strong>, N = 197<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;treatment&lt;/strong&gt;, N = 204&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>treatment</strong>, N = 204<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">change</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">20.34 (4.7)  \n[197]</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">50.24 (4.5)  \n[204]</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"3\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> Mean (SD)<br />\n[No. obs.]</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\nThis makes sense, the mean change of \\~20 and \\~50 for the control and treatment groups (respectively) aligns with what we asked for in the data generation process.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndat %>% \n  tibble %>% \n  pivot_wider(id_cols = c(id, group), names_from = timepoint, values_from = c(out, time)) %>% \n  mutate(change = out_post - out_pre) %>% \n  select(group, change) %>% \n  ggplot(aes(group, change, colour = group)) +\n  geom_violin(aes(fill = group), alpha = 0.1) +\n  geom_jitter(width = 0.1, height = 0, alpha = 0.3) +\n  theme_clean() +\n  scale_colour_viridis_d(option = \"plasma\", end = 0.85) +\n  scale_fill_viridis_d(option = \"plasma\", end = 0.85) +\n  labs(y = \"Outcome\", x = \"Timepoint\",\n       title = \"Pre-post change score analysis\", \n       subtitle = \"Two-groups, violin plot with jittered points\", colour = \"Group\", fill = \"Group\")\n```\n\n::: {.cell-output-display}\n![](pre-post_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=576}\n:::\n:::\n\n\n\n\n\nWith one observation per participant and two groups (and approximately normally distributed data), we can use a `t.test` to evaluate the difference between groups.\n\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 methods overwritten by 'broom':\n  method            from  \n  tidy.glht         jtools\n  tidy.summary.glht jtools\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 7\n  estimate statistic   p.value conf.low conf.high method             alternative\n     <dbl>     <dbl>     <dbl>    <dbl>     <dbl> <chr>              <chr>      \n1    -29.9     -64.9 3.13e-213    -30.8     -29.0 Welch Two Sample … two.sided  \n```\n\n\n:::\n:::\n\n\n\n\n\nThe output suggests:\n\n-   A difference between groups means of \\~30.\n\nThis exact result, with using a change score as the outcome, can also be reached using linear regression (left to the reader).\n\n## Linear regression (ANCOVA framework)\n\nHere, the outcome variable is the post-value with the treatment variable as the exposure of interest (RHS of the model).\n\n`lm(out_post ~ out_pre + group, data = dat)`\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"zmbrshzinm\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#zmbrshzinm table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#zmbrshzinm thead, #zmbrshzinm tbody, #zmbrshzinm tfoot, #zmbrshzinm tr, #zmbrshzinm td, #zmbrshzinm th {\n  border-style: none;\n}\n\n#zmbrshzinm p {\n  margin: 0;\n  padding: 0;\n}\n\n#zmbrshzinm .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 14px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zmbrshzinm .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#zmbrshzinm .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zmbrshzinm .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zmbrshzinm .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zmbrshzinm .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zmbrshzinm .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zmbrshzinm .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zmbrshzinm .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zmbrshzinm .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zmbrshzinm .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zmbrshzinm .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zmbrshzinm .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#zmbrshzinm .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zmbrshzinm .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zmbrshzinm .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zmbrshzinm .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zmbrshzinm .gt_row {\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zmbrshzinm .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zmbrshzinm .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zmbrshzinm .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zmbrshzinm .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#zmbrshzinm .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zmbrshzinm .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zmbrshzinm .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zmbrshzinm .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zmbrshzinm .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zmbrshzinm .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zmbrshzinm .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zmbrshzinm .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zmbrshzinm .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zmbrshzinm .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zmbrshzinm .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zmbrshzinm .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zmbrshzinm .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zmbrshzinm .gt_left {\n  text-align: left;\n}\n\n#zmbrshzinm .gt_center {\n  text-align: center;\n}\n\n#zmbrshzinm .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zmbrshzinm .gt_font_normal {\n  font-weight: normal;\n}\n\n#zmbrshzinm .gt_font_bold {\n  font-weight: bold;\n}\n\n#zmbrshzinm .gt_font_italic {\n  font-style: italic;\n}\n\n#zmbrshzinm .gt_super {\n  font-size: 65%;\n}\n\n#zmbrshzinm .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#zmbrshzinm .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zmbrshzinm .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zmbrshzinm .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zmbrshzinm .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zmbrshzinm .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zmbrshzinm .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Beta&lt;/strong&gt;\"><strong>Beta</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;95% CI&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>95% CI</strong><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;p-value&lt;/strong&gt;\"><strong>p-value</strong></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">20.77</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">19.66, 21.88</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">out_pre</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0.96</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">0.87, 1.05</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">group</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    control</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    treatment</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">30.36</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">29.06, 31.65</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0.001</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"4\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> CI = Confidence Interval</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\nThis output suggests (in order):\n\n-   The intercept (the mean value for a control participant [with 0 as a pre-value]{.underline}) is \\~21\n    -   *This may be curious, we know the post-values for the control group have a mean of \\~30, however, the mean pre -alue for the control groups is \\~10. Take that 10 away from the \\~30, and this is why we see \\~20 here for a control participant [with 0 as a pre-value)]{.underline}*\n-   For every 1 unit increase in a participants pre-value, their post-value will be 0.97 units higher *(... than if their pre-value was 1 unit lower)*\n-   **\\[Perhaps of most interest\\]** The post-values for the treatment group are (on average) \\~30 units higher than the control group.\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndat %>% \n  tibble %>% \n  mutate(timepoint = as.numeric(factor(timepoint, levels = c(\"pre\", \"post\"))) - 1,\n         group = as.numeric(factor(group, levels = c(\"control\", \"treatment\"))) -1) %>% \n  mutate(jittered_pos = jitter(timepoint, amount = 0.05),\n         dodge_pos = group * 0.25 ) %>% #- 0.25/2)\n  mutate(group = factor(group, labels = c(\"control\", \"treatment\"))) %>% \n  ggplot(aes(x = dodge_pos + jittered_pos, y = out, group = id, colour = group)) +\n  geom_point(aes(x = dodge_pos + jittered_pos), \n             position = position_dodge(width = 0.25), alpha = 0.3) +\n  geom_line(aes(x = dodge_pos + jittered_pos), alpha = 0.2) +\n  scale_x_continuous(breaks = 0:1, labels = c(\"pre\", \"post\")) +\n  theme_clean() +\n  scale_colour_viridis_d(option = \"plasma\", end = 0.85) +\n  labs(y = \"Outcome\", x = \"Timepoint\",\n       title = \"Pre-post analysis\", \n       subtitle = \"Two-groups, jitterplot with line connecting pairs of observations\", colour = \"Group\")\n```\n\n::: {.cell-output-display}\n![](pre-post_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=576}\n:::\n:::\n\n\n\n\n\nWith lines connecting each pairs' data points together, we can perhaps more clearly see that those with a higher pre-value also have a higher post-value! *(What might the data look like if this wasn't the case...)*\n\nBut you may be wondering ...?\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndat_b <- dat %>% \n  mutate(timepoint = factor(timepoint, levels = c(\"pre\", \"post\"))) %>% \n  group_by(group, timepoint) %>% \n  summarise(out_sd = sd(out),\n            out = mean(out)) %>% \n  filter(timepoint == \"post\")\n\ndat %>% \n  mutate(timepoint = factor(timepoint, levels = c(\"pre\", \"post\"))) %>% \n  ggplot(aes(timepoint, out)) +\n  geom_jitter(aes(colour = group, group = group), \n              position = position_jitterdodge(jitter.width = 0.1, dodge.width = 0.35), alpha = 0.3) +\n  geom_smooth(aes(colour = group, group = group), \n              position = position_dodge(width = 0.45),\n              method = \"lm\", formula= y ~ x, alpha = 0.6) +\n  theme_clean() +\n  theme(legend.position = \"bottom\") +\n  scale_colour_viridis_d(option = \"plasma\", end = 0.85) +\n  labs(y = \"Outcome\", x = \"Timepoint\",\n       title = \"Pre-post analysis\", \n       subtitle = \"Two-groups, jitterplot with line connecting observed means\", colour = \"Group\") +\n  stat_brace(data = dat_b, aes(group = timepoint), \n             rotate = 90, width = 0.1, outerstart = 2.2, bending = 1) +\n  scale_y_continuous(breaks = seq(0,100,10)) +\n  geom_text(data = tibble(timepoint = c(2.35),\n                          out = c(50.8), # (71.2-30.4) / 2 + 30.4\n                          label = c(\"A difference of ~40?\\nThe model said ~30?\")),\n            aes(label = label), size = 3.5, hjust = 0) +\n  coord_cartesian(xlim = c(1.25, 2.35)) \n```\n\n::: {.cell-output-display}\n![](pre-post_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=576}\n:::\n:::\n\n\n\n\n\n::: {.column-margin}\n**ggbrace()**\n\nIt was a bit of a battle with stat_brace() to get the annotation in there, but it was worth it, Shirley!\n:::\n\n\nWe know the post-value means are \\~40 units apart, yet the model has returned the value of \\~30 for the 'treatment effect', which (implicitly) has adjusted for the baseline difference between groups of \\~10 units.\n\n## Linear mixed effects models\n\nHere, the outcome variable includes both the pre- and post-measures with the interaction on the RHS of the model allowing the effect of the treatment variable (as the exposure of interest) to vary according to time.\n\n`lmer(out ~ group*timepoint + (1 | id), data = dat)`\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"gjiywuhjay\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#gjiywuhjay table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#gjiywuhjay thead, #gjiywuhjay tbody, #gjiywuhjay tfoot, #gjiywuhjay tr, #gjiywuhjay td, #gjiywuhjay th {\n  border-style: none;\n}\n\n#gjiywuhjay p {\n  margin: 0;\n  padding: 0;\n}\n\n#gjiywuhjay .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 14px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#gjiywuhjay .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#gjiywuhjay .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#gjiywuhjay .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#gjiywuhjay .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gjiywuhjay .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gjiywuhjay .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gjiywuhjay .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#gjiywuhjay .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#gjiywuhjay .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#gjiywuhjay .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#gjiywuhjay .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#gjiywuhjay .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#gjiywuhjay .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#gjiywuhjay .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#gjiywuhjay .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#gjiywuhjay .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#gjiywuhjay .gt_row {\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#gjiywuhjay .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gjiywuhjay .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#gjiywuhjay .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#gjiywuhjay .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#gjiywuhjay .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gjiywuhjay .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#gjiywuhjay .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#gjiywuhjay .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gjiywuhjay .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gjiywuhjay .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#gjiywuhjay .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gjiywuhjay .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#gjiywuhjay .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gjiywuhjay .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gjiywuhjay .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gjiywuhjay .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gjiywuhjay .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gjiywuhjay .gt_left {\n  text-align: left;\n}\n\n#gjiywuhjay .gt_center {\n  text-align: center;\n}\n\n#gjiywuhjay .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#gjiywuhjay .gt_font_normal {\n  font-weight: normal;\n}\n\n#gjiywuhjay .gt_font_bold {\n  font-weight: bold;\n}\n\n#gjiywuhjay .gt_font_italic {\n  font-style: italic;\n}\n\n#gjiywuhjay .gt_super {\n  font-size: 65%;\n}\n\n#gjiywuhjay .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#gjiywuhjay .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#gjiywuhjay .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#gjiywuhjay .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#gjiywuhjay .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#gjiywuhjay .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#gjiywuhjay .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Beta&lt;/strong&gt;\"><strong>Beta</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;95% CI&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>95% CI</strong><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">10.11</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">9.28, 10.94</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">group</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    control</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">—</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    treatment</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">10.44</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">9.27, 11.61</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">timepoint</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    pre</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">—</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    post</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">20.34</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">19.69, 20.98</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">group * timepoint</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"ci\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    treatment * post</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">29.91</td>\n<td headers=\"ci\" class=\"gt_row gt_center\">29.00, 30.81</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"3\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> CI = Confidence Interval</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\nThis output suggests (in order):\n\n-   The intercept (mean value for a control participant at the [pre-measure]{.underline}) is \\~10 (makes sense)\n-   The treatment group mean (at the [pre-measure]{.underline}) is \\~11 units higher than the control group mean (makes sense)\n-   The post-values *in the **control group*** are (on average) \\~20 units higher than the pre-values \n-   \\[**Perhaps of most interest\\]** Compared to the \\~20 unit difference (over time) in the control group, the post-values in the treatment group are (an additional) \\~30 units higher than the pre-values (total of 50 units difference between pre and post)\n\nIn looking at, and breaking down, this output, you might think that the linear mixed effects model gives you the same answer but with a much more explicit breakdown of many other 'things going on' with your outcome data - and you'd be right.\n\n# Conclusion\n\nFor a basic pre-post design, both an ANCOVA framework implemented with linear regression and a linear mixed effects model will quite easily return an unbiased estimate of the post treatment (intervention) effect allowing for adjustment of any baseline imbalance in your outcome variable. Change score analysis may give a similar result, but the framework is restrictive in the way that other variables and design complexity can be handled.\n\nWhile ANCOVA framework (implemented with linear regression) is typically recommended, the linear mixed effects model can give a more verbose breakdown of the data with the estimates it returns, providing explicit insights into the outcome variable between groups and across time.\n\nBoth approaches [**have other assumptions and design features**]{.underline} that should be considered when deciding which to use and how to present the results.\n\n## Acknowledgements\n\nThanks to Elizabeth McKinnon, Zac Dempsey, and Wesley Billingham for providing feedback on and reviewing this post.\n\nYou can look forward to seeing posts from these other team members here in the coming weeks and months.\n\n## Reproducibility Information\n\nTo access the .qmd (Quarto markdown) files as well as any R scripts or data that was used in this post, [please visit our GitHub](https://github.com/The-Kids-Biostats/The-Kids-Biostats.github.io/tree/main/posts/pre_post):\n\nThe session information can also be seen below.\n\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-apple-darwin20\nRunning under: macOS Sonoma 14.5\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Australia/Perth\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] ggbrace_0.1.1     gtsummary_1.7.2   jtools_2.2.2      lme4_1.1-35.4    \n [5] Matrix_1.7-0      data.table_1.15.4 simstudy_0.8.0    lubridate_1.9.3  \n [9] forcats_1.0.0     stringr_1.5.1     dplyr_1.1.4       purrr_1.0.2      \n[13] readr_2.1.5       tidyr_1.3.1       tibble_3.2.1      ggplot2_3.5.1    \n[17] tidyverse_2.0.0  \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.5         xfun_0.46            htmlwidgets_1.6.4   \n [4] lattice_0.22-6       tzdb_0.4.0           vctrs_0.6.5         \n [7] tools_4.4.0          generics_0.1.3       parallel_4.4.0      \n[10] fansi_1.0.6          pkgconfig_2.0.3      uuid_1.2-0          \n[13] gt_0.10.1            lifecycle_1.0.4      farver_2.1.2        \n[16] compiler_4.4.0       munsell_0.5.1        codetools_0.2-20    \n[19] htmltools_0.5.8.1    sass_0.4.9           yaml_2.3.9          \n[22] furrr_0.3.1          pillar_1.9.0         nloptr_2.1.0        \n[25] crayon_1.5.3         MASS_7.3-60.2        broom.helpers_1.15.0\n[28] broom.mixed_0.2.9.5  boot_1.3-30          parallelly_1.37.1   \n[31] nlme_3.1-164         commonmark_1.9.1     tidyselect_1.2.1    \n[34] digest_0.6.36        future_1.33.2        stringi_1.8.4       \n[37] listenv_0.9.1        pander_0.6.5         labeling_0.4.3      \n[40] splines_4.4.0        labelled_2.13.0      fastmap_1.2.0       \n[43] grid_4.4.0           colorspace_2.1-0     cli_3.6.3           \n[46] magrittr_2.0.3       utf8_1.2.4           broom_1.0.6         \n[49] bigmemory.sri_0.1.8  bigmemory_4.6.4      withr_3.0.0         \n[52] scales_1.3.0         backports_1.5.0      timechange_0.3.0    \n[55] rmarkdown_2.27       globals_0.16.3       hms_1.1.3           \n[58] fastglm_0.0.3        evaluate_0.24.0      haven_2.5.4         \n[61] knitr_1.48           viridisLite_0.4.2    mgcv_1.9-1          \n[64] markdown_1.13        rlang_1.1.4          Rcpp_1.0.13         \n[67] glue_1.7.0           xml2_1.3.6           rstudioapi_0.16.0   \n[70] minqa_1.2.7          jsonlite_1.8.8       R6_2.5.1            \n```\n\n\n:::\n:::\n",
    "supporting": [
      "pre-post_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}